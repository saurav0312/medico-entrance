
<div style="margin-top: 10em; margin-bottom: 1em; text-align: center;">
    <div class="container  bg-blue mt-5 mb-5">
      <div class="row">
        
          <div class=" border" style="text-align: center; display: inline; border-color: #7c766f !important;">
              <div class="p-3">
                  <div class="mb-3">
                      <h4 class="align-items-center" style="display: inline; text-align: center;"><b>Edit Test</b></h4>
                  </div>
    
                  <form (ngSubmit)="modifyMockTest()" name="modifyMockTestForm" [formGroup]="modifyMockTestForm" >
                    <div>
                        <mat-form-field style="width: 100%;" appearance="outline" >
                            <mat-label>Test Name</mat-label>
                            <input formControlName="testName" type="text" required matInput >
                            <mat-error *ngIf="modifyMockTestForm.get('testName')?.dirty && modifyMockTestForm.get('testName')?.errors">
                                Test name is required
                            </mat-error>
                        </mat-form-field>
                    </div>
    
                    <div>
                      <mat-form-field style="width: 100%;" appearance="outline">
                          <mat-label>Test Taker</mat-label>
                          <input formControlName="testTakenBy" type="text" required matInput>
                          <mat-error *ngIf="modifyMockTestForm.get('testTakenBy')?.dirty && modifyMockTestForm.get('testTakenBy')?.errors">
                            Test Taker name is required
                          </mat-error>
                      </mat-form-field>
                    </div>
    
                    <div>
                        <mat-form-field style="width: 100%;" appearance="outline">
                            <mat-label>Total Time</mat-label>
                            <input formControlName="totalTime" type="number" required matInput>
                            <mat-error *ngIf="modifyMockTestForm.get('totalTime')?.dirty && modifyMockTestForm.get('totalTime')?.errors">
                              Total time is required
                            </mat-error>
                            <mat-error *ngIf="modifyMockTestForm.get('totalTime')?.errors">
                              {{modifyMockTestForm.get('totalTime')?.errors | json}}
    
                            </mat-error>
                        </mat-form-field>
                    </div>
    
                    <div>
                      <mat-form-field style="width: 100%;" appearance="outline">
                          <mat-label>Total No of Questions</mat-label>
                          <input formControlName="totalNumberOfQuestions" type="number" required matInput>
                          <mat-error *ngIf="modifyMockTestForm.get('totalNumberOfQuestions')?.dirty && modifyMockTestForm.get('totalNumberOfQuestions')?.errors">
                            Total No of Questions is required
                          </mat-error>
                      </mat-form-field>
                    </div>
    
                    <div style="text-align: left; margin-bottom: 1em;">
                      <!-- <mat-form-field style="width: 100%;" appearance="outline"> -->
                          <mat-label style="text-align: left;">Test Type: </mat-label>
                          <mat-radio-group formControlName="testType" [(ngModel)]="testType" aria-label="Test Type">
                            <mat-radio-button (change)="testTypeChanged($event)" [checked]="testType === 'Free'" value="Free">Free</mat-radio-button>
                            <mat-radio-button [checked]="testType === 'Paid'" value="Paid">Paid</mat-radio-button>
                          </mat-radio-group>
                          <!-- <input formControlName="testType" type="text" required matInput> -->
                          <mat-error *ngIf="modifyMockTestForm.get('testType')?.dirty && modifyMockTestForm.get('testType')?.errors">
                            Test Type is required
                          </mat-error>
                      <!-- </mat-form-field> -->
                    </div>
    
                    <div>
                      <mat-form-field *ngIf="modifyMockTestForm.get('testType')?.value === 'Paid'" style="width: 100%;" appearance="outline">
                          <mat-label>Test Price</mat-label>
                          <input formControlName="testPrice" type="number" [required]="modifyMockTestForm.get('testType')?.value === 'Paid'" matInput>
                          <mat-error *ngIf="modifyMockTestForm.get('testPrice')?.dirty && modifyMockTestForm.get('testType')?.value === 'Paid' && modifyMockTestForm.get('testPrice')?.errors">
                            Test Price is required
                          </mat-error>
                      </mat-form-field>
                    </div>

                    <div>
                        <mat-form-field style="width: 100%;" appearance="outline">
                            <mat-label>Edit Question No</mat-label>
                            <mat-select [disabled]="modifyMockTestForm.invalid" [(value)]="selectedValue" name="question">
                              <mat-option *ngFor="let question of testQuestions; let i = index" [value]="i">
                                {{i+1}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                    </div>

                    <div *ngIf="selectedValue !== undefined">
                        <mat-form-field (change)="updateQuestion(selectedValue, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Question</mat-label>
                            <textarea formControlName="question" required matInput value="{{testQuestions[selectedValue]?.question}}"></textarea>
                        </mat-form-field>

                        <mat-form-field (change)="updateOption(selectedValue,0, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Option 1</mat-label>
                            <input formControlName="optionA" required matInput value="{{testQuestions[selectedValue].options[0]}}">
                        </mat-form-field>

                        <mat-form-field (change)="updateOption(selectedValue,1, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Option 2</mat-label>
                            <input formControlName="optionB" required matInput value="{{testQuestions[selectedValue].options[1]}}">
                        </mat-form-field>

                        <mat-form-field (change)="updateOption(selectedValue,2, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Option 3</mat-label>
                            <input formControlName="optionC" required matInput value="{{testQuestions[selectedValue].options[2]}}">
                        </mat-form-field>

                        <mat-form-field (change)="updateOption(selectedValue,3, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Option 4</mat-label>
                            <input formControlName="optionD" required matInput value="{{testQuestions[selectedValue].options[3]}}">
                        </mat-form-field>

                        <mat-form-field (change)="updateCorrectAnswer(selectedValue, $event)" style="width: 100%;" appearance="outline">
                            <mat-label>Correct Answer</mat-label>
                            <input formControlName="correctAnswer" required matInput value="{{testQuestions[selectedValue]?.correctAnswer}}">
                        </mat-form-field>
                        <!-- 
                        <p > Options: {{testQuestions[selectedValue]?.options}} </p>
                        <p > Correct Answer: {{testQuestions[selectedValue]?.correctAnswer}} </p> -->
                    </div>
                    {{modifyMockTestForm.invalid}}    
                    <div>
                        <button style="margin-right: em; margin-top: 1em;" mat-raised-button type="button" (click) = "clearForm()" class="cancel-class">Cancel</button>
                        <button style="margin-left: 5em ; margin-right: 1em; margin-top: 1em;" mat-raised-button color="primary" [disabled]="modifyMockTestForm.invalid">Save</button>
                    </div>
                  </form>
              </div>
          </div>
        
    </div>
</div>

<app-spinner [loading]="loading" [mode]="'indeterminate'" [diameter]="50" [overlay]="true">
</app-spinner>
