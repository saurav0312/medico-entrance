
<!-- Bootstrap test -->
<ng-container *ngIf='!viewResult; else detailedResultBlock'>
    <ng-container *ngIf="!testFinished; else testFinsihedBlock">
        <div>
            <h1 style="text-align: center; margin-top: 1em;">
                {{totalTimeRemaining}}
                <mat-icon aria-label="home icom">
                    timer
                </mat-icon>
            </h1>
            
        </div>    
        <div class="float-container" style="width: fit-content; float: left;">
            <div class="float-child mat-card" style="width: auto;">
                <div class="card" style="float: left; width: 50em; min-width: 20em; max-width: 50em ;">
                    <div class="card-body">
                        <h1 class="card-title">{{counter + 1}}. {{testData.questions[counter]?.question}}</h1>
                        <ol>
                            <div>
                                <li style ="height: 2.5em;" (click)="optionSelected(counter,option)" class="card options-item"
                                [ngClass]="testData.questions[counter].selectedOption === option ? 'option-selected' : 'option-not-selected'"  *ngFor="let option of testData.questions[counter]?.options" style="cursor: pointer; margin: 10px 0;">{{option}}</li>
                            </div>
                        </ol>
                    </div>
                </div>

                <div>
                    <button class="btn btn-primary" [disabled]="counter === 0"  (click)="decreaseCounter()" style="width:fit-content; float: lef; margin-top: 1em; ">Previous</button>
                    <button class="btn btn-primary" [disabled]="counter === testData.questions.length-1" (click)="increaseCounter()" style="width:fit-content; float: right; margin-top: 1em;">Next</button>
                </div>
            </div>

            <div class="float-child mat-card" style="width: 25em; margin-left: 2em; float: right;" >
                <div   *ngFor="let question of testData.questions; let i = index" [attr.data-index]="i">
                    <div style="float: left; column-width: 4em;">
                        <button style ="width:3rem; height: auto;" (click)="changeQuestion(i)" [ngClass]="{'question-number-btn-class-focus' : counter === i, 'question-number-answered': testData.questions[i].answered === true}" class="btn question-number-btn-class">{{i+1}}</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="clear"></div>

        <div style="padding-left: 49em;">
            <button (click)="submitTest()" class="btn btn-primary"> Submit</button>
        </div>
    </ng-container>
</ng-container>

<ng-template  #testFinsihedBlock>
    <div style="text-align: center;">
        <h1>User ID: {{userId}}</h1>
        <h1>Test ID: {{testId}}</h1>
        <h1>Test has been finished successfully</h1>
        <h2>Your test result is here</h2>
        <div>
            <h3>Questions Attempted: </h3> {{noOfQuestionsAttempted}}
            <h3>Questions Unattempted: </h3> {{noOfQuestionsUnattempted}}
            <h3>Questions Answered Correctly: </h3> {{noOfQuestionsAnsweredCorrectly}}
            <h3>Questions Answered Incorrectly</h3>{{noOfQuestionsAnsweredIncorrectly}}
        </div>
        <button class="btn btn-primary" (click)="viewDetailReport()">View Detail Result</button>
    </div>
</ng-template>

<ng-template #detailedResultBlock>

    <app-detailtestreport
        [displayedColumns] = displayedColumns 
        [testToShowInTable] = testToShowInTable>

    </app-detailtestreport>
<!-- <h1 style="text-align: center;">Here is your detail performance report</h1>
    <div style="text-align: center; margin-bottom: 3em;"><b>TestId: {{testToShowInTable.testId}}</b>&nbsp; Date: {{testToShowInTable.testTakenDate}}</div>
    <div style="float: right; margin-right: 11.7em;">
        <button mat-raised-button style="margin-left: 1em;" (click)="exporter.exportTable('xlsx', {fileName:'test', sheet: 'sheet_name', Props: {Author: 'OnlineExam'}})">Excel</button>
        <button mat-raised-button style="margin-left: 1em;" (click)="exporter.exportTable('csv')">Csv</button>
        <button mat-raised-button style="margin-left: 1em;" (click)="exporter.exportTable('json')">Json</button>
        <button mat-raised-button style="margin-left: 1em;" (click)="exporter.exportTable('txt')">Txt</button>
    </div> 
    <div style="clear: both;"></div>
    <div [ngClass]="'mat-elevation-z8'" class="table-contents">
        <mat-table matTableExporter [dataSource] = "dataSource"  #exporter="matTableExporter"> 

            <ng-container matColumnDef="question">
                <mat-header-cell  *matHeaderCellDef> Question </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.question}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="selectedOption">
                <mat-header-cell *matHeaderCellDef> Selected Option </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.selectedOption}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="correctAnswer">
                <mat-header-cell *matHeaderCellDef> Correct Answer </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.correctAnswer}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="result">
                <mat-header-cell [ngClass]="'quest-width'" *matHeaderCellDef> Result </mat-header-cell>
                <mat-cell [ngClass]="'quest-width'" *matCellDef="let element">
                    <div> 
                        <mat-icon *ngIf ='element.correctAnswer === element.selectedOption' style="color: green;">done</mat-icon>
                        <mat-icon *ngIf ='element.selectedOption!== null && element.correctAnswer !== element.selectedOption' style="color: red;">close</mat-icon>
                        <mat-icon *ngIf ='element.selectedOption === null' style="color: green;">question_mark</mat-icon> 
                    </div>
                </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>

            
        </mat-table>
        <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div> -->
</ng-template>



